---
import Layout from '~/layouts/PageLayout.astro';
import Header from '~/components/widgets/Header.astro';
import Hero from '~/components/widgets/Hero.astro';
import Features2 from '~/components/widgets/Features2.astro';
import Features3 from '~/components/widgets/Features3.astro';
import Content from '~/components/widgets/Content.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';
import WidgetWrapper from '~/components/ui/WidgetWrapper.astro';
import Lightbox from '~/components/common/Lightbox.astro';
import { getPermalink } from '~/utils/permalinks';

const metadata = {
  title: 'Pricing & Payment â€” 3D Printing Services',
  description:
    'Flexible pricing for 3D printing services. All prices are negotiable - contact us directly to discuss your project and get a custom quote.',
};
---

<Layout metadata={metadata}>
  <Fragment slot="announcement"></Fragment>
  <Fragment slot="header">
    <Header
      links={[
        { text: 'Home', href: getPermalink('/homes/3d-printing') },
        { text: 'Services', href: getPermalink('/homes/3d-printing#services') },
        { text: 'Pricing', href: getPermalink('/homes/pricing') },
        { text: 'Products', href: getPermalink('/homes/3d-printing#products') },
        { text: 'Contact', href: getPermalink('/contact#form') },
      ]}
      actions={[
        {
          text: 'Get Quote',
          href: getPermalink('/homes/pricing#contact-quote'),
        },
      ]}
      isSticky
      showToggleTheme
      showLogo={false}
    />
  </Fragment>

  <!-- Hero Widget ******************* -->

  <Hero
    id="hero"
    title="Pricing & Payment"
    tagline="Flexible Pricing for Your Projects"
    actions={[
      { variant: 'primary', text: 'Request a Quote', href: getPermalink('/homes/pricing#contact-quote') },
      { variant: 'secondary', text: 'View Services', href: getPermalink('/homes/3d-printing#services') },
    ]}
  >
    <Fragment slot="subtitle">
      All prices are negotiable! We believe in fair, transparent pricing tailored to your specific project needs.
      Contact us directly to discuss your requirements and receive a personalized quote.
    </Fragment>
    <Fragment slot="bg">
      <div class="absolute inset-0 overflow-hidden">
        <!-- Colorful gradient background -->
        <div
          class="absolute inset-0 bg-gradient-to-br from-blue-400 via-purple-500 via-pink-500 to-orange-400 dark:from-blue-900 dark:via-purple-900 dark:via-pink-900 dark:to-orange-900"
        >
        </div>
        <!-- Animated gradient overlay for depth -->
        <div
          class="absolute inset-0 bg-gradient-to-tr from-cyan-400/30 via-transparent to-yellow-400/30 dark:from-cyan-600/20 dark:to-yellow-600/20"
        >
        </div>
        <!-- Subtle pattern overlay -->
        <div
          class="absolute inset-0 opacity-10 dark:opacity-5"
          style="background-image: radial-gradient(circle at 2px 2px, rgba(255,255,255,0.3) 1px, transparent 0); background-size: 60px 60px;"
        >
        </div>
        <!-- Overlay for better text readability -->
        <div
          class="absolute inset-0 bg-gradient-to-t from-white/70 via-white/30 to-transparent dark:from-slate-900/85 dark:via-slate-900/50 dark:to-transparent"
        >
        </div>
        <!-- Additional subtle overlay for contrast -->
        <div class="absolute inset-0 bg-white/20 dark:bg-slate-900/30"></div>
      </div>
    </Fragment>
  </Hero>

  <!-- Content Widget - Pricing Information **************** -->

  <Content
    id="pricing-info"
    title="Pricing Information"
    subtitle="Transparent, negotiable pricing based on your project requirements."
    items={[
      {
        title: 'Project-Based Pricing',
        description:
          'Each project is unique, and so is our pricing. We consider factors like material type, print volume, complexity, post-processing requirements, and turnaround time when providing quotes.',
      },
      {
        title: 'Negotiable Rates',
        description:
          "All prices are negotiable! We work with you to find a pricing solution that fits your budget while maintaining quality standards. Don't hesitate to discuss your budget with us.",
      },
      {
        title: 'Volume Discounts',
        description:
          'Bulk orders and repeat customers may be eligible for discounted rates. Contact us to discuss volume pricing options for larger projects or ongoing partnerships.',
      },
    ]}
    image={{
      src: 'https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80',
      alt: 'Pricing and Payment',
      width: 800,
      height: 600,
    }}
  >
    <Fragment slot="content">
      <h2 class="text-2xl font-bold tracking-tight dark:text-white sm:text-3xl mb-4">How We Price</h2>
      <p class="text-muted mb-4">
        Our pricing is designed to be fair, transparent, and flexible. We understand that every project has different
        requirements, and we're committed to working with you to find a pricing solution that works for both of us.
      </p>
      <p class="text-muted">
        <strong>Important:</strong> All prices are negotiable. We encourage you to contact us directly to discuss your project,
        requirements, and budget. We're here to help bring your ideas to life at a price that works for you.
      </p>
    </Fragment>

    <Fragment slot="bg">
      <div class="absolute inset-0 overflow-hidden">
        <div
          class="absolute inset-0 bg-gradient-to-br from-blue-50 via-cyan-50 to-purple-50 dark:from-blue-950/30 dark:via-cyan-950/30 dark:to-purple-950/30"
        >
        </div>
        <div
          class="absolute inset-0 opacity-15 dark:opacity-8"
          style="background-image: linear-gradient(45deg, rgba(99, 102, 241, 0.1) 25%, transparent 25%), linear-gradient(-45deg, rgba(99, 102, 241, 0.1) 25%, transparent 25%); background-size: 30px 30px;"
        >
        </div>
      </div>
    </Fragment>
  </Content>

  <!-- Features3 Widget - Pricing Factors ************** -->

  <Features3
    title="What Affects Pricing"
    subtitle="Understanding the factors that influence project costs."
    columns={3}
    defaultIcon="tabler:currency-dollar"
    items={[
      {
        title: 'Material Type',
        description:
          'Different materials (ABS, PLA, PETG, TPU) have varying costs. Premium or specialty materials may affect pricing.',
      },
      {
        title: 'Print Volume',
        description:
          'Larger prints or higher quantities may qualify for volume discounts. Small prototypes typically have base pricing.',
      },
      {
        title: 'Complexity',
        description:
          'Complex designs requiring supports, intricate details, or multiple parts may require additional time and material.',
      },
      {
        title: 'Post-Processing',
        description:
          'Additional services like sanding, painting, assembly, or special finishing will be added to the base price.',
      },
      {
        title: 'Design Services',
        description:
          'If you need custom 3D modeling or design work, this will be included in your quote based on complexity.',
      },
      {
        title: 'Turnaround Time',
        description:
          'Rush orders or expedited delivery may incur additional charges. Standard turnaround is typically included.',
      },
    ]}
  >
    <Fragment slot="bg">
      <div class="absolute inset-0 overflow-hidden">
        <div
          class="absolute inset-0 bg-gradient-to-br from-purple-50 via-pink-50 to-orange-50 dark:from-purple-950/30 dark:via-pink-950/30 dark:to-orange-950/30"
        >
        </div>
        <div
          class="absolute inset-0 opacity-20 dark:opacity-10"
          style="background-image: radial-gradient(circle at 2px 2px, rgba(139, 92, 246, 0.2) 1px, transparent 0); background-size: 50px 50px;"
        >
        </div>
      </div>
    </Fragment>
  </Features3>

  <!-- Contact Form Widget ************** -->

  <WidgetWrapper id="contact-quote" containerClass="max-w-4xl mx-auto">
    <div class="text-center mb-8">
      <h2 class="text-4xl md:text-5xl font-bold tracking-tighter mb-4 font-heading">Get Your Custom Quote</h2>
      <p class="max-w-3xl mx-auto text-xl text-muted dark:text-slate-400">
        Fill out the form below with your project details, and we will get back to you with a personalized quote within
        24-48 hours.
      </p>
    </div>

    <div
      class="max-w-2xl mx-auto rounded-lg backdrop-blur border border-gray-200 dark:border-gray-700 bg-white dark:bg-slate-900 shadow-lg p-6 sm:p-8 lg:p-10"
    >
      <form id="quote-form" action="https://formspree.io/f/xlgeqvqk" method="POST" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label for="name" class="block text-sm font-medium mb-2">
              Name <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              id="name"
              name="name"
              required
              class="py-3 px-4 block w-full text-md rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary focus:border-transparent"
              placeholder="Your name"
            />
          </div>
          <div>
            <label for="email" class="block text-sm font-medium mb-2">
              Email <span class="text-red-500">*</span>
            </label>
            <input
              type="email"
              id="email"
              name="email"
              required
              class="py-3 px-4 block w-full text-md rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary focus:border-transparent"
              placeholder="your.email@example.com"
            />
          </div>
        </div>

        <div>
          <label for="phone" class="block text-sm font-medium mb-2">Phone (Optional)</label>
          <input
            type="tel"
            id="phone"
            name="phone"
            class="py-3 px-4 block w-full text-md rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary focus:border-transparent"
            placeholder="+45 12345678"
          />
        </div>

        <div>
          <label for="projectDetails" class="block text-sm font-medium mb-2">Project Type</label>
          <select
            id="projectDetails"
            name="projectDetails"
            class="py-3 px-4 block w-full text-md rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary focus:border-transparent"
          >
            <option value="">Select project type...</option>
            <option value="3D Printing">3D Printing</option>
            <option value="3D Design">3D Design</option>
            <option value="Figurine/Anime Merch">Figurine/Anime Merch</option>
            <option value="Post-Processing">Post-Processing</option>
            <option value="Other">Other</option>
          </select>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label for="material" class="block text-sm font-medium mb-2">Material Preference</label>
            <select
              id="material"
              name="material"
              class="py-3 px-4 block w-full text-md rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary focus:border-transparent"
            >
              <option value="">Select material...</option>
              <option value="ABS">ABS</option>
              <option value="PLA">PLA</option>
              <option value="PETG">PETG</option>
              <option value="TPU">TPU</option>
              <option value="Not sure">Not sure</option>
            </select>
          </div>
          <div>
            <label for="quantity" class="block text-sm font-medium mb-2">Quantity</label>
            <input
              type="text"
              id="quantity"
              name="quantity"
              class="py-3 px-4 block w-full text-md rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary focus:border-transparent"
              placeholder="e.g., 1, 5, 10+"
            />
          </div>
        </div>

        <div>
          <label for="message" class="block text-sm font-medium mb-2">
            Project Details & Message <span class="text-red-500">*</span>
          </label>
          <textarea
            id="message"
            name="message"
            required
            rows="6"
            class="py-3 px-4 block w-full text-md rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-slate-900 focus:ring-2 focus:ring-primary focus:border-transparent"
            placeholder="Please describe your project, requirements, timeline, and any other details..."></textarea>
        </div>

        <div id="form-message" class="hidden p-4 rounded-lg"></div>

        <button
          type="submit"
          class="w-full py-3 px-6 bg-primary text-white font-medium rounded-lg hover:bg-primary/90 transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"
        >
          Submit Quote Request
        </button>
      </form>
    </div>

    <Fragment slot="bg">
      <div class="absolute inset-0 overflow-hidden">
        <div
          class="absolute inset-0 bg-gradient-to-br from-indigo-50 via-blue-50 to-cyan-50 dark:from-indigo-950/30 dark:via-blue-950/30 dark:to-cyan-950/30"
        >
        </div>
        <div
          class="absolute inset-0 opacity-15 dark:opacity-8"
          style="background-image: radial-gradient(circle at 1px 1px, rgba(99, 102, 241, 0.15) 1px, transparent 0); background-size: 40px 40px;"
        >
        </div>
      </div>
    </Fragment>
  </WidgetWrapper>

  <script is:inline>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('quote-form');
      const messageDiv = document.getElementById('form-message');
      const submitButton = form?.querySelector('button[type="submit"]');

      if (!form || !messageDiv || !submitButton) return;

      // Show loading state when form is submitted
      form.addEventListener('submit', () => {
        const originalText = submitButton.textContent;
        submitButton.disabled = true;
        submitButton.textContent = 'Sending...';

        // Formspree will handle the submission and redirect
        // This just provides visual feedback
      });
    });
  </script>

  <!-- Content Widget - Payment Information **************** -->

  <Content
    id="payment"
    title="Payment Options"
    subtitle="Flexible payment methods to suit your needs."
    isReversed
    items={[
      {
        title: 'Payment Methods',
        description:
          'We accept various payment methods including bank transfers, mobile payments, and other convenient options. Payment terms can be discussed based on project size and timeline.',
      },
      {
        title: 'Payment Terms',
        description:
          'For larger projects, we may offer payment plans or milestone-based payments. Standard projects typically require payment upon completion or delivery.',
      },
      {
        title: 'Secure Transactions',
        description:
          'All payment information is handled securely. We will discuss payment details and terms directly with you when finalizing your project quote.',
      },
    ]}
  >
    <Fragment slot="content">
      <h2 class="text-2xl font-bold tracking-tight dark:text-white sm:text-3xl mb-4">Payment Process</h2>
      <p class="text-muted mb-4">
        Once we have agreed on a price for your project, we will discuss payment options and terms that work for both
        parties. We are flexible and can accommodate various payment preferences.
      </p>
      <p class="text-muted">
        <strong>Note:</strong> Payment terms are negotiable and will be clearly communicated before work begins. We're committed
        to making the payment process as smooth and convenient as possible.
      </p>
    </Fragment>

    <Fragment slot="bg">
      <div class="absolute inset-0 overflow-hidden">
        <div
          class="absolute inset-0 bg-gradient-to-br from-pink-50 via-orange-50 to-yellow-50 dark:from-pink-950/30 dark:via-orange-950/30 dark:to-yellow-950/30"
        >
        </div>
        <div
          class="absolute inset-0 opacity-15 dark:opacity-8"
          style="background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(236, 72, 153, 0.1) 10px, rgba(236, 72, 153, 0.1) 20px);"
        >
        </div>
      </div>
    </Fragment>
  </Content>

  <!-- CallToAction Widget *********** -->

  <CallToAction
    title="Ready to Get Started?"
    subtitle="Contact us today to discuss your project and receive a personalized, negotiable quote."
    actions={[
      {
        variant: 'primary',
        text: 'Request a Quote',
        href: getPermalink('/homes/pricing#contact-quote'),
      },
      {
        variant: 'secondary',
        text: 'Call Us',
        href: getPermalink('/contact#form')
      },
    ]}
  >
    <Fragment slot="bg">
      <div class="absolute inset-0 overflow-hidden">
        <div
          class="absolute inset-0 bg-gradient-to-br from-blue-400/10 via-purple-500/10 via-pink-500/10 to-orange-400/10 dark:from-blue-900/20 dark:via-purple-900/20 dark:via-pink-900/20 dark:to-orange-900/20"
        >
        </div>
        <div
          class="absolute inset-0 opacity-10 dark:opacity-5"
          style="background-image: radial-gradient(circle at 3px 3px, rgba(99, 102, 241, 0.2) 1px, transparent 0); background-size: 55px 55px;"
        >
        </div>
      </div>
    </Fragment>
  </CallToAction>

  <!-- Image Lightbox Modal -->
  <div
    id="image-lightbox"
    class="fixed inset-0 z-50 hidden items-center justify-center bg-black bg-opacity-90 backdrop-blur-sm"
    role="dialog"
    aria-modal="true"
    aria-labelledby="lightbox-image-alt"
  >
    <button
      id="lightbox-close"
      class="absolute top-4 right-4 z-10 rounded-full bg-white/10 p-2 text-white hover:bg-white/20 transition-colors"
      aria-label="Close lightbox"
    >
      <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
    <div class="relative max-h-[90vh] max-w-[90vw] p-4">
      <img id="lightbox-image" src="" alt="" class="max-h-[90vh] max-w-full rounded-lg object-contain" />
    </div>
  </div>

  <Lightbox />
</Layout>
